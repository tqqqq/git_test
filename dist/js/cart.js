"use strict";var xmlhttp,table = document.getElementById("table");function del(e) {if (confirm("确认删除？")) {var t = e.parentNode.parentNode.rowIndex;table.deleteRow(t);}total();}function sub(e) {var t = e.parentNode.children[1],n = e.parentNode.parentNode.children[2],a = e.parentNode.parentNode.children[4];"-" == e.innerHTML ? t.value = 1 < Number(t.value) ? Number(t.value - 1) : 1 : t.value = Number(t.value) < 5 ? Number(t.value) + 1 : 5, much(t.value, n.innerHTML, a), total();}function much(e, t, n) {var a = e * t;n.innerHTML = a.toFixed(2);}function all1(e) {var t = document.getElementsByClassName("check");if (e.checked) for (var n = 0; n < t.length; n++) {t[n].checked = !0;} else for (n = 0; n < t.length; n++) {t[n].checked = !1;}total();}function check_radio() {for (var e = !0, t = document.getElementsByClassName("check"), n = 1; n < t.length - 1; n++) {if (0 == t[n].checked) {e = !1;break;}}e ? (t[0].checked = !0, t[t.length - 1].checked = !0) : (t[0].checked = !1, t[t.length - 1].checked = !1), total();}function total() {for (var e = 0, t = 0, n = document.getElementsByClassName("check"), a = document.getElementsByClassName("zongpro_shu")[0], r = document.getElementsByClassName("zongjia_shu")[0], c = 2; c < n.length; c++) {n[c].checked && (e += parseFloat(n[c].parentNode.parentNode.children[4].innerHTML), t++);}a.innerHTML = t, r.innerHTML = e + ".00";}function delall() {for (var e = !1, t = document.querySelectorAll(".check"), n = 1; n < t.length - 1; n++) {t[n].checked && (e = !0);}if (1 == e) for (n = 1; n < t.length - 1; n++) {if (t[n].checked) if (1 == confirm("确认删除选中商品吗？")) {var a = t[n].parentElement.parentElement.parentElement,r = t[n].parentElement.parentElement;a.removeChild(r);}} else alert("未勾选商品");}function quit(e) {e.onclick = function () {if (confirm("确认退出吗？")) {this.innerHTML = "", this.previousElementSibling.innerHTML = "注册";var e = document.getElementById("username");e.innerHTML = "登录", e.nextElementSibling.innerHTML = "", window.localStorage.userName = "";var t = document.getElementById("go_count");console.log(t), t.innerHTML = "0";}};}xmlhttp = window.XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject("Microsoft.XMLHTTP"), window.onload = function () {if (window.localStorage.userName) {var e = document.getElementById("username"),t = document.getElementById("sign_up_quit"),n = document.createElement("a");t.innerHTML = "", t.parentNode.appendChild(n), n.innerHTML = "[退出]", n.id = "quit", e.innerHTML = "";var a = document.createElement("span");e.parentNode.appendChild(a);var r = window.localStorage.userName;a.innerHTML = "欢迎您！" + r, a.style.color = "#F01BC0", quit(n);var c = window.localStorage.userName;xmlhttp.open("GET", "php/addcar.php?user=" + c, !0), xmlhttp.send(), xmlhttp.onreadystatechange = function () {if (4 == xmlhttp.readyState && 200 == xmlhttp.status) {var e = JSON.parse(xmlhttp.responseText),t = document.getElementById("go_count");t.innerHTML = e.length, window.localStorage.gogocount = t.innerHTML;for (var n = document.getElementById("table"), a = 0; a < e.length; a++) {var r = document.createElement("tr");n.appendChild(r);var c = document.createElement("td");r.appendChild(c);var l = document.createElement("input");c.appendChild(l), l.type = "checkbox", l.name = "check", l.setAttribute("checked", "checked"), l.setAttribute("class", "check"), l.setAttribute("onclick", "check_radio()");var d = document.createElement("td");r.appendChild(d), d.setAttribute("class", "pro");var o = document.createElement("img"),i = document.createElement("p"),m = document.createElement("a");i.appendChild(m), m.innerHTML = e[a].title, d.appendChild(o), o.setAttribute("src", e[a].src), d.appendChild(i);var u = document.createElement("td");r.appendChild(u), u.setAttribute("class", "money"), u.innerHTML = e[a].price;var p = document.createElement("td");r.appendChild(p), p.className = "count";var h = document.createElement("button"),s = document.createElement("input"),v = document.createElement("button");p.appendChild(h), h.setAttribute("onclick", "sub(this)"), h.innerHTML = "-", p.appendChild(s), s.setAttribute("value", "1"), s.disabled = !0, p.appendChild(v), v.setAttribute("onclick", "sub(this)"), v.innerHTML = "+";var g = document.createElement("td");r.appendChild(g), g.innerHTML = u.innerHTML * s.value;var E = document.createElement("td");r.appendChild(E), E.className = "del";var f = document.createElement("a");E.appendChild(f), f.setAttribute("onclick", "del(this)"), f.innerHTML = "删除";}total();}};}};